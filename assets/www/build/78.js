webpackJsonp([78],{2086:function(n,e,l){"use strict";function View_AddonStorageManagerCoursesStoragePage_2(n){return t._57(0,[(n()(),t._31(0,0,null,null,2,"h3",[],null,null,null,null,null)),(n()(),t._55(1,null,["",""])),t._47(131072,I.a,[N.a,t.j])],null,function(n,e){n(e,1,0,t._56(e,1,0,t._44(e,2).transform("core.downloading")))})}function View_AddonStorageManagerCoursesStoragePage_1(n){return t._57(0,[(n()(),t._31(0,0,null,null,28,"ion-item",[["class","course item item-block"]],null,null,null,$.b,$.a)),t._30(1,1097728,null,3,F.a,[G.a,T.a,t.t,t.V,[2,H.a]],null,null),t._52(335544320,4,{contentLabel:0}),t._52(603979776,5,{_buttons:1}),t._52(603979776,6,{_icons:1}),t._30(5,16384,null,0,W.a,[],null,null),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(7,0,null,2,1,"h2",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._55(8,null,["",""])),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._26(16777216,null,2,1,null,View_AddonStorageManagerCoursesStoragePage_2)),t._30(11,16384,null,0,J.k,[t._11,t._6],{ngIf:[0,"ngIf"]},null),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(13,0,null,2,5,"p",[],null,null,null,null,null)),(n()(),t._55(-1,null,["\n                        "])),(n()(),t._31(15,0,null,null,1,"ion-icon",[["item-start",""],["name","cube"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._30(16,147456,[[6,4]],0,K.a,[T.a,t.t,t.V],{name:[0,"name"]},null),(n()(),t._55(17,null,["\n                        ","\n                    "])),t._49(18,1),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(20,0,null,4,7,"button",[["icon-only",""],["ion-button",""],["item-end",""]],[[8,"disabled",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.deleteCourse(n.context.$implicit)&&t}return t},q.b,q.a)),t._30(21,1097728,[[5,4]],0,B.a,[[8,""],T.a,t.t,t.V],null,null),(n()(),t._55(-1,0,["\n                        "])),(n()(),t._31(23,0,null,0,3,"core-icon",[["name","trash"]],null,null,null,Q.b,Q.a)),t._30(24,704512,null,0,X.a,[t.t,T.a],{name:[0,"name"],ariaLabel:[1,"ariaLabel"]},null),t._48(25,{name:0}),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,0,["\n                    "])),(n()(),t._55(-1,2,["\n                "]))],function(n,e){n(e,11,0,e.context.$implicit.isDownloading);n(e,16,0,"cube");n(e,24,0,"trash",t._34(1,"",t._56(e,24,1,t._44(e,26).transform("addon.storagemanager.deletedatafrom",n(e,25,0,e.context.$implicit.name))),""))},function(n,e){n(e,8,0,e.context.$implicit.displayname);n(e,15,0,t._44(e,16)._hidden);n(e,17,0,t._56(e,17,0,n(e,18,0,t._44(e.parent,0),e.context.$implicit.totalSize)));n(e,20,0,e.context.$implicit.isDownloading)})}function View_AddonStorageManagerCoursesStoragePage_0(n){return t._57(0,[t._47(0,Y.a,[Z.b,nn.b]),(n()(),t._31(1,0,null,null,12,"ion-header",[],null,null,null,null,null)),t._30(2,16384,null,0,en.a,[T.a,t.t,t.V,[2,ln.a]],null,null),(n()(),t._55(-1,null,["\n    "])),(n()(),t._31(4,0,null,null,8,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,tn.b,tn.a)),t._30(5,49152,null,0,an.a,[on.a,[2,ln.a],[2,rn.a],T.a,t.t,t.V],null,null),t._30(6,212992,null,0,un.a,[an.a,sn.a,N.a,b.b],null,null),(n()(),t._55(-1,3,["\n        "])),(n()(),t._31(8,0,null,3,3,"ion-title",[],null,null,null,dn.b,dn.a)),t._30(9,49152,null,0,cn.a,[T.a,t.t,t.V,[2,_n.a],[2,an.a]],null,null),(n()(),t._55(10,0,["",""])),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,3,["\n    "])),(n()(),t._55(-1,null,["\n"])),(n()(),t._55(-1,null,["\n"])),(n()(),t._31(15,0,null,null,63,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,gn.b,gn.a)),t._30(16,4374528,null,0,fn.a,[T.a,sn.a,hn.a,t.t,t.V,on.a,bn.a,t.M,[2,ln.a],[2,rn.a]],null,null),(n()(),t._55(-1,1,["\n    "])),(n()(),t._31(18,0,null,1,59,"core-loading",[],null,null,null,pn.b,pn.a)),t._30(19,638976,null,0,mn.a,[N.a,t.t,b.b,wn.b],{hideUntil:[0,"hideUntil"]},null),(n()(),t._55(-1,0,["\n        "])),(n()(),t._31(21,0,null,0,44,"ion-card",[],null,null,null,null,null)),t._30(22,16384,null,0,Cn.a,[T.a,t.t,t.V],null,null),(n()(),t._55(-1,null,["\n            "])),(n()(),t._31(24,0,null,null,40,"ion-card-header",[],null,null,null,null,null)),t._30(25,16384,null,0,Sn.a,[T.a,t.t,t.V],null,null),(n()(),t._55(-1,null,["\n                "])),(n()(),t._31(27,0,null,null,2,"h1",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._55(28,null,["",""])),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,null,["\n                "])),(n()(),t._31(31,0,null,null,2,"p",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._55(32,null,["",""])),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,null,["\n                "])),(n()(),t._31(35,0,null,null,28,"ion-item",[["class","size item item-block"],["no-padding",""],["padding-top",""],["text-wrap",""]],null,null,null,$.b,$.a)),t._30(36,1097728,null,3,F.a,[G.a,T.a,t.t,t.V,[2,H.a]],null,null),t._52(335544320,1,{contentLabel:0}),t._52(603979776,2,{_buttons:1}),t._52(603979776,3,{_icons:1}),t._30(40,16384,null,0,W.a,[],null,null),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(42,0,null,0,1,"ion-icon",[["item-start",""],["name","cube"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._30(43,147456,[[3,4]],0,K.a,[T.a,t.t,t.V],{name:[0,"name"]},null),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(45,0,null,2,2,"h2",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._55(46,null,["",""])),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(49,0,null,4,5,"div",[["item-end",""]],null,null,null,null,null)),(n()(),t._55(-1,null,["\n                        "])),(n()(),t._31(51,0,null,null,2,"p",[["text-end",""]],null,null,null,null,null)),(n()(),t._55(52,null,["",""])),t._49(53,1),(n()(),t._55(-1,null,["\n                    "])),(n()(),t._55(-1,2,["\n                    "])),(n()(),t._31(56,0,null,4,6,"button",[["icon-only",""],["ion-button",""],["item-end",""],["no-padding",""]],[[8,"disabled",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.deleteCompletelyDownloadedCourses()&&t}return t},q.b,q.a)),t._30(57,1097728,[[2,4]],0,B.a,[[8,""],T.a,t.t,t.V],null,null),(n()(),t._55(-1,0,["\n                        "])),(n()(),t._31(59,0,null,0,2,"core-icon",[["name","trash"]],null,null,null,Q.b,Q.a)),t._30(60,704512,null,0,X.a,[t.t,T.a],{name:[0,"name"],ariaLabel:[1,"ariaLabel"]},null),t._47(131072,I.a,[N.a,t.j]),(n()(),t._55(-1,0,["\n                    "])),(n()(),t._55(-1,2,["\n                "])),(n()(),t._55(-1,null,["\n            "])),(n()(),t._55(-1,null,["\n        "])),(n()(),t._55(-1,0,["\n        "])),(n()(),t._31(67,0,null,0,9,"ion-card",[],null,null,null,null,null)),t._30(68,16384,null,0,Cn.a,[T.a,t.t,t.V],null,null),(n()(),t._55(-1,null,["\n            "])),(n()(),t._31(70,0,null,null,5,"ion-list",[],null,null,null,null,null)),t._30(71,16384,null,0,vn.a,[T.a,t.t,t.V,sn.a,yn.l,hn.a],null,null),(n()(),t._55(-1,null,["\n                "])),(n()(),t._26(16777216,null,null,1,null,View_AddonStorageManagerCoursesStoragePage_1)),t._30(74,802816,null,0,J.j,[t._11,t._6,t.E],{ngForOf:[0,"ngForOf"]},null),(n()(),t._55(-1,null,["\n            "])),(n()(),t._55(-1,null,["\n        "])),(n()(),t._55(-1,0,["\n    "])),(n()(),t._55(-1,1,["\n"])),(n()(),t._55(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,6,0);n(e,19,0,l.loaded);n(e,43,0,"cube");n(e,60,0,"trash",t._34(1,"",t._56(e,60,1,t._44(e,61).transform("addon.storagemanager.deletecourses")),""));n(e,74,0,l.downloadedCourses)},function(n,e){var l=e.component;n(e,4,0,t._44(e,5)._hidden,t._44(e,5)._sbPadding);n(e,10,0,t._56(e,10,0,t._44(e,11).transform("addon.storagemanager.managestorage")));n(e,15,0,t._44(e,16).statusbarPadding,t._44(e,16)._hasRefresher);n(e,28,0,t._56(e,28,0,t._44(e,29).transform("core.courses.courses")));n(e,32,0,t._56(e,32,0,t._44(e,33).transform("addon.storagemanager.info")));n(e,42,0,t._44(e,43)._hidden);n(e,46,0,t._56(e,46,0,t._44(e,47).transform("addon.storagemanager.storageused")));n(e,52,0,t._56(e,52,0,n(e,53,0,t._44(e,0),l.totalSize)));n(e,56,0,0===l.completelyDownloadedCourses.length)})}Object.defineProperty(e,"__esModule",{value:!0});var t=l(0),a=l(5),o=l(3),r=l(26),u=l(32),s=l(110),i=l(15),d=l(56),c=l(802),_=l(52),g=l(37),f=l(4),h=l(51),b=l(9),p=l(38),m=this&&this.__assign||Object.assign||function(n){for(var e,l=1,t=arguments.length;l<t;l++){e=arguments[l];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},w=this&&this.__decorate||function(n,e,l,t){var a,o=arguments.length,r=o<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,l):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(n,e,l,t);else for(var u=n.length-1;u>=0;u--)(a=n[u])&&(r=(o<3?a(r):o>3?a(e,l,r):a(e,l))||r);return o>3&&r&&Object.defineProperty(e,l,r),r},C=this&&this.__awaiter||function(n,e,l,t){return new(l||(l=Promise))(function(a,o){function fulfilled(n){try{step(t.next(n))}catch(n){o(n)}}function rejected(n){try{step(t.throw(n))}catch(n){o(n)}}function step(n){n.done?a(n.value):new l(function(e){e(n.value)}).then(fulfilled,rejected)}step((t=t.apply(n,e||[])).next())})},S=this&&this.__generator||function(n,e){function verb(o){return function(u){return function step(o){if(l)throw new TypeError("Generator is already executing.");for(;r;)try{if(l=1,t&&(a=t[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,t=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(n,r)}catch(n){o=[6,n],t=0}finally{l=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}var l,t,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},v=function(){function AddonStorageManagerCoursesStoragePage(){this.userCourses=[],this.downloadedCourses=[],this.completelyDownloadedCourses=[],this.totalSize=0,this.loaded=!1}return AddonStorageManagerCoursesStoragePage.prototype.ionViewDidLoad=function(){return C(this,void 0,void 0,function(){var n,e,l,t=this;return S(this,function(a){switch(a.label){case 0:return n=this,[4,d.a.instance.getUserCourses()];case 1:return n.userCourses=a.sent(),this.courseStatusObserver=b.a.instance.on(b.b.COURSE_STATUS_CHANGED,function(n){return t.onCourseUpdated(n.courseId,n.status)}),[4,i.a.instance.getDownloadedCourseIds()];case 2:return e=a.sent(),[4,Promise.all(this.userCourses.filter(function(n){return-1!==e.indexOf(n.id)}).map(function(n){return t.getDownloadedCourse(n)}))];case 3:return l=a.sent(),this.setDownloadedCourses(l),this.loaded=!0,[2]}})})},AddonStorageManagerCoursesStoragePage.prototype.ngOnDestroy=function(){this.courseStatusObserver&&this.courseStatusObserver.off()},AddonStorageManagerCoursesStoragePage.prototype.deleteCompletelyDownloadedCourses=function(){return C(this,void 0,void 0,function(){var n,e,l,t;return S(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,f.a.instance.showDeleteConfirm("core.course.confirmdeletemodulefiles")];case 1:return a.sent(),[3,3];case 2:if(!(n=a.sent()).coreCanceled)throw n;return[2];case 3:e=f.a.instance.showModalLoading(),l=this.completelyDownloadedCourses.map(function(n){return n.id}),a.label=4;case 4:return a.trys.push([4,6,7,8]),[4,Promise.all(l.map(function(n){return p.a.instance.deleteCourseFiles(n)}))];case 5:return a.sent(),this.setDownloadedCourses(this.downloadedCourses.filter(function(n){return!c.a.contains(l,n.id)})),[3,8];case 6:return t=a.sent(),f.a.instance.showErrorModalDefault(t,h.a.instance.instant("core.errordeletefile")),[3,8];case 7:return e.dismiss(),[7];case 8:return[2]}})})},AddonStorageManagerCoursesStoragePage.prototype.deleteCourse=function(n){return C(this,void 0,void 0,function(){var e,l,t;return S(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,f.a.instance.showDeleteConfirm("core.course.confirmdeletemodulefiles")];case 1:return a.sent(),[3,3];case 2:if(!(e=a.sent()).coreCanceled)throw e;return[2];case 3:l=f.a.instance.showModalLoading(),a.label=4;case 4:return a.trys.push([4,6,7,8]),[4,p.a.instance.deleteCourseFiles(n.id)];case 5:return a.sent(),this.setDownloadedCourses(c.a.withoutItem(this.downloadedCourses,n)),[3,8];case 6:return t=a.sent(),f.a.instance.showErrorModalDefault(t,h.a.instance.instant("core.errordeletefile")),[3,8];case 7:return l.dismiss(),[7];case 8:return[2]}})})},AddonStorageManagerCoursesStoragePage.prototype.onCourseUpdated=function(n,e){return C(this,void 0,void 0,function(){var l,t;return S(this,function(a){switch(a.label){case 0:return n==i.b.ALL_COURSES_CLEARED?(this.setDownloadedCourses([]),[2]):(l=this.downloadedCourses.find(function(e){return e.id===n}))?(l.isDownloading=e===g.a.DOWNLOADING,t=l,[4,this.calculateDownloadedCourseSize(l.id)]):[2];case 1:return t.totalSize=a.sent(),this.setDownloadedCourses(this.downloadedCourses),[2]}})})},AddonStorageManagerCoursesStoragePage.prototype.setDownloadedCourses=function(n){this.downloadedCourses=n,this.completelyDownloadedCourses=n.filter(function(n){return!n.isDownloading}),this.totalSize=this.downloadedCourses.reduce(function(n,e){return n+e.totalSize},0)},AddonStorageManagerCoursesStoragePage.prototype.getDownloadedCourse=function(n){return C(this,void 0,void 0,function(){var e,l;return S(this,function(t){switch(t.label){case 0:return[4,this.calculateDownloadedCourseSize(n.id)];case 1:return e=t.sent(),[4,i.a.instance.getCourseStatus(n.id)];case 2:return l=t.sent(),[2,m({},n,{totalSize:e,isDownloading:l===g.a.DOWNLOADING})]}})})},AddonStorageManagerCoursesStoragePage.prototype.calculateDownloadedCourseSize=function(n){return C(this,void 0,void 0,function(){var e,l,t,a,o=this;return S(this,function(r){switch(r.label){case 0:return[4,i.a.instance.getSections(n)];case 1:return e=r.sent(),l=c.a.flatten(e.map(function(n){return n.modules})),t=l.map(function(e){return C(o,void 0,void 0,function(){var l;return S(this,function(t){switch(t.label){case 0:return[4,_.a.instance.getModuleDownloadedSize(e,n)];case 1:return l=t.sent(),[2,isNaN(l)?0:l]}})})}),[4,Promise.all(t)];case 2:return a=r.sent(),[2,a.reduce(function(n,e){return n+e},0)]}})})},AddonStorageManagerCoursesStoragePage=w([Object(t.m)({selector:"page-addon-storagemanager-courses-storage",templateUrl:"courses-storage.html"})],AddonStorageManagerCoursesStoragePage)}(),y=this&&this.__decorate||function(n,e,l,t){var a,o=arguments.length,r=o<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,l):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(n,e,l,t);else for(var u=n.length-1;u>=0;u--)(a=n[u])&&(r=(o<3?a(r):o>3?a(e,l,r):a(e,l))||r);return o>3&&r&&Object.defineProperty(e,l,r),r},D=function(){function AddonStorageManagerCoursesStoragePageModule(){}return AddonStorageManagerCoursesStoragePageModule=y([Object(t.I)({declarations:[v],imports:[r.a,u.a,s.a,a.l.forChild(v),o.b.forChild()]})],AddonStorageManagerCoursesStoragePageModule)}(),P=l(1570),M=l(1571),A=l(1572),O=l(1573),V=l(1574),j=l(1575),x=l(1576),L=l(1577),k=l(1578),z=l(1579),R=l(1580),E=l(1581),U=l(1582),I=l(25),N=l(18),$=l(31),F=l(21),G=l(19),T=l(8),H=l(27),W=l(33),J=l(7),K=l(48),q=l(47),B=l(44),Q=l(85),X=l(78),Y=l(1603),Z=l(6),nn=l(10),en=l(387),ln=l(41),tn=l(749),an=l(217),on=l(35),rn=l(22),un=l(491),sn=l(16),dn=l(750),cn=l(325),_n=l(253),gn=l(184),fn=l(28),hn=l(34),bn=l(111),pn=l(57),mn=l(53),wn=l(2),Cn=l(79),Sn=l(328),vn=l(87),yn=l(45),Dn=t._29({encapsulation:2,styles:[],data:{}}),Pn=t._27("page-addon-storagemanager-courses-storage",v,function View_AddonStorageManagerCoursesStoragePage_Host_0(n){return t._57(0,[(n()(),t._31(0,0,null,null,1,"page-addon-storagemanager-courses-storage",[],null,null,null,View_AddonStorageManagerCoursesStoragePage_0,Dn)),t._30(1,180224,null,0,v,[],null,null)],null,null)},{},{},[]),Mn=l(23),An=l(383),On=l(384),Vn=l(386),jn=l(385),xn=l(490),Ln=l(748),kn=l(281);l.d(e,"AddonStorageManagerCoursesStoragePageModuleNgFactory",function(){return zn});var zn=t._28(D,[],function(n){return t._40([t._41(512,t.o,t._21,[[8,[P.a,M.a,A.a,O.a,V.a,j.a,x.a,L.a,k.a,z.a,R.a,E.a,U.a,Pn]],[3,t.o],t.K]),t._41(4608,J.m,J.l,[t.G,[2,J.w]]),t._41(4608,Mn.x,Mn.x,[]),t._41(4608,Mn.d,Mn.d,[]),t._41(4608,An.b,An.a,[]),t._41(4608,On.a,On.b,[]),t._41(4608,Vn.b,Vn.a,[]),t._41(4608,jn.b,jn.a,[]),t._41(4608,N.a,N.a,[xn.a,An.b,On.a,Vn.b,jn.b,N.b,N.c]),t._41(512,J.b,J.b,[]),t._41(512,Mn.v,Mn.v,[]),t._41(512,Mn.i,Mn.i,[]),t._41(512,Mn.s,Mn.s,[]),t._41(512,Ln.a,Ln.a,[]),t._41(512,o.b,o.b,[]),t._41(512,u.a,u.a,[]),t._41(512,s.a,s.a,[]),t._41(512,r.a,r.a,[]),t._41(512,Ln.b,Ln.b,[]),t._41(512,D,D,[]),t._41(256,N.c,void 0,[]),t._41(256,N.b,void 0,[]),t._41(256,kn.a,v,[])])})}});